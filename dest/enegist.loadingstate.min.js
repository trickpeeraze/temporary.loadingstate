!function(a){"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){var b=require("enegist");a.fn.loadingState=function(b){"use strict";function c(a){if(!h){i=a;var b=m;g.removeClass(j).addClass(a).addClass("disabled").prop("disabled",!0).text(f.loadingText),h=setInterval(function(){g.setElementText(n[b%m]),b++},f.speed)}}function d(a,b,c,d){j=a,clearInterval(h),h=null,g.removeClass(i).addClass(a).setElementText(b||k),void 0!==typeof c&&c===parseInt(c)?setTimeout(function(){g.removeClass(a).removeClass("disabled").prop("disabled",!1).setElementText(k),"function"==typeof d&&d.call(g[0])},c):g.prop("disabled",!1)}var e={speed:500,loadingText:"Loading",animated:{frame:["",".","..","..."],side:"right"}},f=a.extend({},e,b),g=this;g.setElementText=function(a){return this.is("input")?this.val(a):this.html(a)},g.getElementText=function(){return this.is("input")?this.val():this.text()};for(var h,i,j,k=g.getElementText(),l=g.css("textAlign"),m=f.animated.frame.length,n=[],o=this.is("input")?" ":"&nbsp;",p=0;m>p;p++){var q;switch(f.animated.side){case"both":q=f.animated.frame[p]+f.loadingText+f.animated.frame[p];break;case"right":q="left"===l?f.loadingText+f.animated.frame[p]:o.repeat(f.animated.frame[p].length)+f.loadingText+f.animated.frame[p];break;case"left":default:q="left"===l?f.animated.frame[p]+f.loadingText+o.repeat(f.animated.frame[p].length):f.animated.frame[p]+f.loadingText}n.push(q)}var r={};return r.start=function(){c("")},r.stop=function(a,b,c){d("",a,b,c)},r.progress=function(){c("progress")},r.done=function(a,b,c){d("success",a,b,c)},r.fail=function(a,b,c){d("error",a,b,c)},r},b.isUndefined(String.repeat)&&(String.prototype.repeat=function(a){return new Array(a+1).join(this)})});